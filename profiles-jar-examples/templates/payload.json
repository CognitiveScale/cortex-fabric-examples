{
  "payload" : {
    "spark_config": {
      "pyspark": {
        "pyspark_bin": "bin/spark-submit",
        "app_command": [
          "no-join-example",
          "-p",
          "lalit",
          "-c",
          "/app/conf/build-profiles-config.json"
        ],
        "app_location": "local:///app/libs/app.jar",
        "options": {
          "--master": "k8s://https://kubernetes.default.svc:443",
          "--class": "com.c12e.cortex.examples.Application",
          "--deploy-mode": "cluster",
          "--name": "mayank-test-1",
          "--conf": {
            "spark.cortex.client.phoenix.url": "http://cortex-internal.cortex.svc.cluster.local/fabric/v4/graphql",
            "spark.cortex.catalog.impl": "com.c12e.cortex.profiles.catalog.CortexRemoteCatalog",
            "spark.cortex.client.secrets.url": "http://cortex-accounts.cortex.svc.cluster.local:5000",

            "spark.cortex.storage.storageType": "gcs",
            "spark.cortex.storage.gcs.authType": "COMPUTE_ENGINE",
            "spark.cortex.storage.bucket.profiles": "profiles-perf-profiles",

            "spark.executor.instances": "1",
            "spark.driver.memory": "2g",
            "spark.executor.memory": "19g",
            "spark.default.parallelism": "21",
            "spark.kubernetes.driver.requests.cores": "2",
            "spark.kubernetes.driver.limit.cores": "3",
            "spark.sql.shuffle.partitions": 200,
            "spark.task.cpus":"1",
            "spark.kubernetes.executor.limit.cores": "3",
            "spark.kubernetes.executor.request.cores": "3",
            "spark.kubernetes.namespace": "cortex-compute",
            "spark.executor.memoryOverhead": "3G",
            "spark.executor.cores": "3",

            "spark.eventLog.enabled": true,
            "spark.eventLog.dir": "gs://profiles-perf-spark-events/spark-events-v2",
            "spark.eventLog.rolling.enabled": true,
            "spark.eventLog.rolling.maxFileSize": "128m",

            "spark.kubernetes.driver.request.cores": "0.1",
            "spark.kubernetes.driver.master": "https://kubernetes.default.svc:443",
            "spark.kubernetes.authenticate.driver.serviceAccountName": "default",
            "spark.kubernetes.executor.annotation.traffic.sidecar.istio.io/excludeOutboundPorts": "7078,7079",
            "spark.kubernetes.driver.annotation.traffic.sidecar.istio.io/excludeInboundPorts": "7078,7079",
            "spark.kubernetes.driver.podTemplateContainerName": "fabric-action",
            "spark.kubernetes.driverEnv.phoenix.groupBy": "true",
            "spark.executor.extraJavaOptions": "-Dlogback.configurationFile=/opt/spark/jars/logback.xml",
            "spark.executor.heartbeatInterval": "100s",
            "spark.network.timeout": "300s",
            "spark.shuffle.service.enabled": "false",
            "spark.dynamicAllocation.enabled": "false",
            "spark.scheduler.mode": "FAIR",
            "spark.sql.streaming.schemaInference": "true",
            "spark.sql.legacy.timeParserPolicy": "LEGACY",
            "spark.sql.adaptive.enabled": "true",
            "spark.sql.adaptive.coalescePartitions.enabled": "true",
            "spark.sql.extensions": "io.delta.sql.DeltaSparkSessionExtension",
            "spark.sql.catalog.spark_catalog": "org.apache.spark.sql.delta.catalog.DeltaCatalog",
            "spark.hadoop.fs.s3a.imp": "org.apache.hadoop.fs.s3a.S3AFileSystem",
            "spark.hadoop.fs.s3a.fast.upload.buffer": "disk",
            "spark.hadoop.fs.s3a.fast.upload": "true",
            "spark.hadoop.fs.s3a.multipart.size": "512M",
            "spark.hadoop.fs.s3a.multipart.threshold": "512M",
            "spark.hadoop.fs.s3a.fast.upload.active.blocks": "2048",
            "spark.hadoop.fs.s3a.committer.threads": "2048",
            "spark.hadoop.fs.s3a.max.total.tasks": "2048",
            "spark.hadoop.fs.s3a.threads.max": "2048",
            "spark.databricks.delta.schema.autoMerge.enabled": "true",
            "spark.databricks.delta.merge.repartitionBeforeWrite.enabled": "true",
            "spark.kubernetes.driver.container.image": "private-registry.test.cvstest.gke.insights.ai/profiles-example:vM5",
            "spark.kubernetes.executor.container.image": "private-registry.test.cvstest.gke.insights.ai/profiles-example:vM5",
            "spark.kubernetes.local.dirs.tmpfs": "false",
            "spark.kubernetes.executor.volumes.persistentVolumeClaim.spark-local-dir-1.options.claimName": "OnDemand",
            "spark.kubernetes.executor.volumes.persistentVolumeClaim.spark-local-dir-1.options.storageClass": "standard-rwo",
            "spark.kubernetes.executor.volumes.persistentVolumeClaim.spark-local-dir-1.options.sizeLimit": "500Gi",
            "spark.kubernetes.executor.volumes.persistentVolumeClaim.spark-local-dir-1.mount.path": "/data",
            "spark.kubernetes.executor.volumes.persistentVolumeClaim.spark-local-dir-1.readOnly": "false"
          }
        }
      }
    }
  }
}
